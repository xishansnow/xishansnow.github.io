<!DOCTYPE html><html class="hide-aside" lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>快速地理加权回归 (FastGWR) | 西山晴雪的知识笔记</title><meta name="keywords" content="GeoAI,空间统计学,变系数模型,地理加权回归"><meta name="author" content="西山晴雪"><meta name="copyright" content="西山晴雪"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="快速地理加权回归 (FastGWR)">
<meta property="og:type" content="article">
<meta property="og:title" content="快速地理加权回归 (FastGWR)">
<meta property="og:url" content="http://xishansnow.github.io/posts/db061403.html">
<meta property="og:site_name" content="西山晴雪的知识笔记">
<meta property="og:description" content="快速地理加权回归 (FastGWR)">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://xishansnow.github.io/img/010.png">
<meta property="article:published_time" content="2023-01-11T02:00:00.000Z">
<meta property="article:modified_time" content="2025-02-17T11:55:02.031Z">
<meta property="article:author" content="西山晴雪">
<meta property="article:tag" content="GeoAI">
<meta property="article:tag" content="空间统计学">
<meta property="article:tag" content="变系数模型">
<meta property="article:tag" content="地理加权回归">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://xishansnow.github.io/img/010.png"><link rel="shortcut icon" href="/img/favi.jpg"><link rel="canonical" href="http://xishansnow.github.io/posts/db061403"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"12DC1Q07CH","apiKey":"7e4ac2a644127298a8a2e8170335afdb","indexName":"xishansnowblog","hits":{"per_page":6},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '快速地理加权回归 (FastGWR)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-02-17 19:55:02'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><meta name="generator" content="Hexo 5.4.2"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/favi.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">389</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">411</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">117</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> 贝叶斯方法</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/posts/4e1bbb89.html"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 索引帖</span></a></li><li><a class="site-page child" href="/categories/%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%BB%9F%E8%AE%A1/%E4%BC%BC%E7%84%B6%E6%96%B9%E6%B3%95/"><i class="fa-fw fa-solid fa-chart-area"></i><span> 似然方法</span></a></li><li><a class="site-page child" href="/categories/%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%BB%9F%E8%AE%A1/%E8%BF%91%E4%BC%BC%E8%B4%9D%E5%8F%B6%E6%96%AF/"><i class="fa-fw fa-solid fa-cube"></i><span> 近似贝叶斯</span></a></li><li><a class="site-page child" href="/categories/%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%BB%9F%E8%AE%A1/MCMC/"><i class="fa-fw fa-solid fa-wand-magic-sparkles"></i><span> MCMC</span></a></li><li><a class="site-page child" href="/categories/%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%BB%9F%E8%AE%A1/%E5%8F%98%E5%88%86%E6%8E%A8%E6%96%AD/"><i class="fa-fw fa-solid fa-layer-group"></i><span> 变分推断</span></a></li><li><a class="site-page child" href="/categories/%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%BB%9F%E8%AE%A1/%E8%B4%9D%E5%8F%B6%E6%96%AF%E4%BC%98%E5%8C%96/"><i class="fa-fw fa-solid fa-gas-pump"></i><span> 贝叶斯优化</span></a></li><li><a class="site-page child" href="/categories/%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%BB%9F%E8%AE%A1/%E6%A6%82%E7%8E%87%E5%9B%BE%E6%A8%A1%E5%9E%8B/"><i class="fa-fw fa-solid fa-magnet"></i><span> 概率图模型</span></a></li><li><a class="site-page child" href="/categories/%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%BB%9F%E8%AE%A1/%E6%A6%82%E7%8E%87%E7%BC%96%E7%A8%8B/"><i class="fa-fw fa-brands fa-codepen"></i><span> 概率编程</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-atom"></i><span> 高斯过程</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/posts/b5b2c876.html"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 索引帖</span></a></li><li><a class="site-page child" href="/categories/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B/%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/"><i class="fa-fw fas fa-atom"></i><span> 高斯过程原理</span></a></li><li><a class="site-page child" href="/categories/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B/%E6%A8%A1%E5%9E%8B%E6%8E%A8%E6%96%AD/"><i class="fa-fw fas fa-cogs"></i><span> 高斯过程推断</span></a></li><li><a class="site-page child" href="/categories/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B/%E5%8F%AF%E6%89%A9%E5%B1%95%E6%80%A7/"><i class="fa-fw fa-solid fa-magnet"></i><span> 可扩展高斯过程</span></a></li><li><a class="site-page child" href="/categories/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"><i class="fa-fw fa-solid fa-layer-group"></i><span> 神经网络高斯过程</span></a></li><li><a class="site-page child" href="/categories/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B/%E8%AF%84%E6%B5%8B%E5%AF%B9%E6%AF%94/"><i class="fa-fw fa-solid fa-school"></i><span> 评测与数据集</span></a></li><li><a class="site-page child" href="/categories/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B/%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA/"><i class="fa-fw fa-solid fa-cube"></i><span> 模型自动构建</span></a></li><li><a class="site-page child" href="/categories/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B/%E9%9A%8F%E6%9C%BA%E6%A8%A1%E6%8B%9F/"><i class="fa-fw fa-solid fa-gas-pump"></i><span> 随机模拟</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-ghost"></i><span> 不确定性DL</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/posts/2b310e69.html"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 索引帖</span></a></li><li><a class="site-page child" href="/categories/BayesNN/%E7%BB%BC%E8%BF%B0%E6%A6%82%E8%A7%88"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 综述性文章</span></a></li><li><a class="site-page child" href="/categories/BayesNN/%E5%8D%95%E4%B8%80%E7%A1%AE%E5%AE%9A%E6%80%A7%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"><i class="fa-fw fas fa-atom"></i><span> 确定性神经网络方法</span></a></li><li><a class="site-page child" href="/categories/BayesNN/%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"><i class="fa-fw fas fa-school"></i><span> 贝叶斯神经网络方法</span></a></li><li><a class="site-page child" href="/categories/BayesNN/%E6%B7%B1%E5%BA%A6%E9%9B%86%E6%88%90/"><i class="fa-fw fas fa-cogs"></i><span> 深度集成方法</span></a></li><li><a class="site-page child" href="/categories/BayesNN/%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA/"><i class="fa-fw fa-solid fa-layer-group"></i><span> 数据增强方法</span></a></li><li><a class="site-page child" href="/categories/BayesNN/%E5%AF%B9%E6%AF%94%E8%AF%84%E6%B5%8B/"><i class="fa-fw fa-solid fa-magnet"></i><span> 对比评测</span></a></li><li><a class="site-page child" href="/categories/%E9%A2%84%E6%B5%8B%E4%BB%BB%E5%8A%A1/%E4%B8%8D%E7%A1%AE%E5%AE%9A%E6%80%A7%E6%A0%A1%E5%87%86/"><i class="fa-fw fa-solid fa-gas-pump"></i><span> 不确定性校准</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-map"></i><span> 时空随机场</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/posts/82ad5ffe.html"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 索引帖</span></a></li><li><a class="site-page child" href="/categories/GeoAI/%E7%A9%BA%E9%97%B4%E6%95%B0%E6%8D%AE%E5%BB%BA%E6%A8%A1/"><i class="fa-fw fa-solid fa-map"></i><span> 时空随机场</span></a></li><li><a class="site-page child" href="/categories/GeoAI/%E7%A9%BA%E9%97%B4%E6%8F%92%E5%80%BC/"><i class="fa-fw fa-solid fa-ghost"></i><span> 时空插值</span></a></li><li><a class="site-page child" href="/categories/GeoAI/%E7%A9%BA%E9%97%B4%E5%9B%9E%E5%BD%92/"><i class="fa-fw fa-brands fa-deezer"></i><span> 回归分析</span></a></li><li><a class="site-page child" href="/categories/GeoAI/%E6%97%B6%E7%A9%BA%E5%9B%9E%E5%BD%92/"><i class="fa-fw fa-brands fa-deezer"></i><span> 时空预报</span></a></li><li><a class="site-page child" href="/categories/GeoAI/%E6%97%B6%E7%A9%BA%E5%9B%9E%E5%BD%92/"><i class="fa-fw fa-brands fa-deezer"></i><span> 数据同化</span></a></li><li><a class="site-page child" href="/categories/GeoAI/%E9%9A%8F%E6%9C%BA%E6%A8%A1%E6%8B%9F/"><i class="fa-fw fa-solid fa-layer-group"></i><span> 计算机实验模拟</span></a></li><li><a class="site-page child" href="/categories/GeoAI/%E9%9A%8F%E6%9C%BA%E6%A8%A1%E6%8B%9F/"><i class="fa-fw fa-solid fa-layer-group"></i><span> 时空监测网络设计</span></a></li><li><a class="site-page child" href="/categories/GeoAI/%E5%9C%BA%E7%BB%98%E5%88%B6/"><i class="fa-fw fa fa-anchor"></i><span> 场绘制专题</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-book-open"></i><span> 书籍</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="https://xishansnow.github.io/BayesianAnalysiswithPython2nd/index.html"><i class="fa-fw fa-solid  fa-landmark-dome"></i><span> 《Bayesian Analysis with Python》</span></a></li><li><a class="site-page child" href="https://xishansnow.github.io/BayesianModelingandComputationInPython/index.html"><i class="fa-fw fa-solid  fa-graduation-cap"></i><span> 《Bayesian Modeling and Computation in Python》</span></a></li><li><a class="site-page child" href="https://xishansnow.github.io/ElementsOfStatisticalLearning/index.html"><i class="fa-fw fa-solid  fa-book-atlas"></i><span> 《统计学习精要（ESL）》</span></a></li><li><a class="site-page child" href="https://xishansnow.github.io/spatialSTAT_CN/index.html"><i class="fa-fw fa-solid  fa-layer-group"></i><span> 《空间统计学》</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://otexts.com/fppcn/index.html"><i class="fa-fw fa-solid  fa-cloud-sun-rain"></i><span> 《预测：方法与实践》</span></a></li><li><a class="site-page child" href="https://xishansnow.github.io/MLAPP/index.html"><i class="fa-fw fa-solid  fa-robot"></i><span> 《机器学习的概率视角（MLAPP）》</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> 索引</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa-solid fa-timeline"></i><span> 时间索引</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签索引</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类索引</span></a></li><li><a class="site-page child" href="/categories/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E5%8F%AF%E8%A7%A3%E9%87%8A%E6%80%A7/"><i class="fa-fw fas fa-atlas"></i><span> 临时索引</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-link"></i><span> 其他</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/"><i class="fa-fw fas fa-utensils"></i><span> 常用软件</span></a></li><li><a class="site-page child" href="/link/paper/"><i class="fa-fw fas fa-book-open"></i><span> 学术工具</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> 摄影作品</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/010.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">西山晴雪的知识笔记</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> 贝叶斯方法</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/posts/4e1bbb89.html"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 索引帖</span></a></li><li><a class="site-page child" href="/categories/%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%BB%9F%E8%AE%A1/%E4%BC%BC%E7%84%B6%E6%96%B9%E6%B3%95/"><i class="fa-fw fa-solid fa-chart-area"></i><span> 似然方法</span></a></li><li><a class="site-page child" href="/categories/%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%BB%9F%E8%AE%A1/%E8%BF%91%E4%BC%BC%E8%B4%9D%E5%8F%B6%E6%96%AF/"><i class="fa-fw fa-solid fa-cube"></i><span> 近似贝叶斯</span></a></li><li><a class="site-page child" href="/categories/%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%BB%9F%E8%AE%A1/MCMC/"><i class="fa-fw fa-solid fa-wand-magic-sparkles"></i><span> MCMC</span></a></li><li><a class="site-page child" href="/categories/%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%BB%9F%E8%AE%A1/%E5%8F%98%E5%88%86%E6%8E%A8%E6%96%AD/"><i class="fa-fw fa-solid fa-layer-group"></i><span> 变分推断</span></a></li><li><a class="site-page child" href="/categories/%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%BB%9F%E8%AE%A1/%E8%B4%9D%E5%8F%B6%E6%96%AF%E4%BC%98%E5%8C%96/"><i class="fa-fw fa-solid fa-gas-pump"></i><span> 贝叶斯优化</span></a></li><li><a class="site-page child" href="/categories/%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%BB%9F%E8%AE%A1/%E6%A6%82%E7%8E%87%E5%9B%BE%E6%A8%A1%E5%9E%8B/"><i class="fa-fw fa-solid fa-magnet"></i><span> 概率图模型</span></a></li><li><a class="site-page child" href="/categories/%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%BB%9F%E8%AE%A1/%E6%A6%82%E7%8E%87%E7%BC%96%E7%A8%8B/"><i class="fa-fw fa-brands fa-codepen"></i><span> 概率编程</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-atom"></i><span> 高斯过程</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/posts/b5b2c876.html"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 索引帖</span></a></li><li><a class="site-page child" href="/categories/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B/%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/"><i class="fa-fw fas fa-atom"></i><span> 高斯过程原理</span></a></li><li><a class="site-page child" href="/categories/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B/%E6%A8%A1%E5%9E%8B%E6%8E%A8%E6%96%AD/"><i class="fa-fw fas fa-cogs"></i><span> 高斯过程推断</span></a></li><li><a class="site-page child" href="/categories/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B/%E5%8F%AF%E6%89%A9%E5%B1%95%E6%80%A7/"><i class="fa-fw fa-solid fa-magnet"></i><span> 可扩展高斯过程</span></a></li><li><a class="site-page child" href="/categories/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"><i class="fa-fw fa-solid fa-layer-group"></i><span> 神经网络高斯过程</span></a></li><li><a class="site-page child" href="/categories/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B/%E8%AF%84%E6%B5%8B%E5%AF%B9%E6%AF%94/"><i class="fa-fw fa-solid fa-school"></i><span> 评测与数据集</span></a></li><li><a class="site-page child" href="/categories/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B/%E8%87%AA%E5%8A%A8%E6%9E%84%E5%BB%BA/"><i class="fa-fw fa-solid fa-cube"></i><span> 模型自动构建</span></a></li><li><a class="site-page child" href="/categories/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B/%E9%9A%8F%E6%9C%BA%E6%A8%A1%E6%8B%9F/"><i class="fa-fw fa-solid fa-gas-pump"></i><span> 随机模拟</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-ghost"></i><span> 不确定性DL</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/posts/2b310e69.html"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 索引帖</span></a></li><li><a class="site-page child" href="/categories/BayesNN/%E7%BB%BC%E8%BF%B0%E6%A6%82%E8%A7%88"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 综述性文章</span></a></li><li><a class="site-page child" href="/categories/BayesNN/%E5%8D%95%E4%B8%80%E7%A1%AE%E5%AE%9A%E6%80%A7%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"><i class="fa-fw fas fa-atom"></i><span> 确定性神经网络方法</span></a></li><li><a class="site-page child" href="/categories/BayesNN/%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"><i class="fa-fw fas fa-school"></i><span> 贝叶斯神经网络方法</span></a></li><li><a class="site-page child" href="/categories/BayesNN/%E6%B7%B1%E5%BA%A6%E9%9B%86%E6%88%90/"><i class="fa-fw fas fa-cogs"></i><span> 深度集成方法</span></a></li><li><a class="site-page child" href="/categories/BayesNN/%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA/"><i class="fa-fw fa-solid fa-layer-group"></i><span> 数据增强方法</span></a></li><li><a class="site-page child" href="/categories/BayesNN/%E5%AF%B9%E6%AF%94%E8%AF%84%E6%B5%8B/"><i class="fa-fw fa-solid fa-magnet"></i><span> 对比评测</span></a></li><li><a class="site-page child" href="/categories/%E9%A2%84%E6%B5%8B%E4%BB%BB%E5%8A%A1/%E4%B8%8D%E7%A1%AE%E5%AE%9A%E6%80%A7%E6%A0%A1%E5%87%86/"><i class="fa-fw fa-solid fa-gas-pump"></i><span> 不确定性校准</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-map"></i><span> 时空随机场</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/posts/82ad5ffe.html"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 索引帖</span></a></li><li><a class="site-page child" href="/categories/GeoAI/%E7%A9%BA%E9%97%B4%E6%95%B0%E6%8D%AE%E5%BB%BA%E6%A8%A1/"><i class="fa-fw fa-solid fa-map"></i><span> 时空随机场</span></a></li><li><a class="site-page child" href="/categories/GeoAI/%E7%A9%BA%E9%97%B4%E6%8F%92%E5%80%BC/"><i class="fa-fw fa-solid fa-ghost"></i><span> 时空插值</span></a></li><li><a class="site-page child" href="/categories/GeoAI/%E7%A9%BA%E9%97%B4%E5%9B%9E%E5%BD%92/"><i class="fa-fw fa-brands fa-deezer"></i><span> 回归分析</span></a></li><li><a class="site-page child" href="/categories/GeoAI/%E6%97%B6%E7%A9%BA%E5%9B%9E%E5%BD%92/"><i class="fa-fw fa-brands fa-deezer"></i><span> 时空预报</span></a></li><li><a class="site-page child" href="/categories/GeoAI/%E6%97%B6%E7%A9%BA%E5%9B%9E%E5%BD%92/"><i class="fa-fw fa-brands fa-deezer"></i><span> 数据同化</span></a></li><li><a class="site-page child" href="/categories/GeoAI/%E9%9A%8F%E6%9C%BA%E6%A8%A1%E6%8B%9F/"><i class="fa-fw fa-solid fa-layer-group"></i><span> 计算机实验模拟</span></a></li><li><a class="site-page child" href="/categories/GeoAI/%E9%9A%8F%E6%9C%BA%E6%A8%A1%E6%8B%9F/"><i class="fa-fw fa-solid fa-layer-group"></i><span> 时空监测网络设计</span></a></li><li><a class="site-page child" href="/categories/GeoAI/%E5%9C%BA%E7%BB%98%E5%88%B6/"><i class="fa-fw fa fa-anchor"></i><span> 场绘制专题</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-book-open"></i><span> 书籍</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="https://xishansnow.github.io/BayesianAnalysiswithPython2nd/index.html"><i class="fa-fw fa-solid  fa-landmark-dome"></i><span> 《Bayesian Analysis with Python》</span></a></li><li><a class="site-page child" href="https://xishansnow.github.io/BayesianModelingandComputationInPython/index.html"><i class="fa-fw fa-solid  fa-graduation-cap"></i><span> 《Bayesian Modeling and Computation in Python》</span></a></li><li><a class="site-page child" href="https://xishansnow.github.io/ElementsOfStatisticalLearning/index.html"><i class="fa-fw fa-solid  fa-book-atlas"></i><span> 《统计学习精要（ESL）》</span></a></li><li><a class="site-page child" href="https://xishansnow.github.io/spatialSTAT_CN/index.html"><i class="fa-fw fa-solid  fa-layer-group"></i><span> 《空间统计学》</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://otexts.com/fppcn/index.html"><i class="fa-fw fa-solid  fa-cloud-sun-rain"></i><span> 《预测：方法与实践》</span></a></li><li><a class="site-page child" href="https://xishansnow.github.io/MLAPP/index.html"><i class="fa-fw fa-solid  fa-robot"></i><span> 《机器学习的概率视角（MLAPP）》</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> 索引</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa-solid fa-timeline"></i><span> 时间索引</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签索引</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类索引</span></a></li><li><a class="site-page child" href="/categories/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E5%8F%AF%E8%A7%A3%E9%87%8A%E6%80%A7/"><i class="fa-fw fas fa-atlas"></i><span> 临时索引</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-link"></i><span> 其他</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/"><i class="fa-fw fas fa-utensils"></i><span> 常用软件</span></a></li><li><a class="site-page child" href="/link/paper/"><i class="fa-fw fas fa-book-open"></i><span> 学术工具</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> 摄影作品</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">快速地理加权回归 (FastGWR)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-01-11T02:00:00.000Z" title="发表于 2023-01-11 10:00:00">2023-01-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-02-17T11:55:02.031Z" title="更新于 2025-02-17 19:55:02">2025-02-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/GeoAI/">GeoAI</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/GeoAI/%E7%A9%BA%E9%97%B4%E5%8F%98%E7%B3%BB%E6%95%B0%E6%A8%A1%E5%9E%8B/">空间变系数模型</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>26分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><script src='https://unpkg.com/tippy.js@2.0.2/dist/tippy.all.min.js'></script>
<script src='/js/attachTooltips.js'></script>
<link rel='stylesheet' href='/css/tippy.css'>
<script src="https://unpkg.com/tippy.js@2.0.2/dist/tippy.all.min.js"></script>
<script src="/js/attachTooltips.js"></script>
<link rel="stylesheet" href="/css/tippy.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>〖摘 要〗 地理加权回归 (GWR) 是一种广泛使用的工具，用于探索地理空间过程的空间异质性。 GWR 计算特定位置的参数估计值，这使得其校准过程需要大量计算。当前开源 GWR 软件可以处理的最大数据点数是标准桌面上的大约 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>15</mn><mo separator="true">,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">15,000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">15</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span></span></span></span> 个观测值。在大数据时代，这严重限制了 GWR 的使用。为了克服这一限制，我们提出了一种高度可扩展的开源 FastGWR 实现，该实现基于 Python 和消息传递接口 (MPI)，可扩展到数百万个观测值的数量级。 FastGWR 优化内存使用以及并行化以显著提高性能。为了说明 FastGWR 的性能，对来自洛杉矶市 Zillow 数据集的大约 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>130</mn></mrow><annotation encoding="application/x-tex">130</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">130</span></span></span></span> 万个单户住宅物业进行了特征房价模型校准，这是将 GWR 应用于这种规模的数据集的首次尝试。结果表明，随着高性能计算 (HPC) 环境中内核数量的增加，FastGWR 呈线性扩展。它还优于当前可用的开源 GWR 软件包，在标准桌面上速度大幅降低——最高可达数千倍。</p>
<p>【原 文】 Li, Z. et al. (2019) ‘Fast Geographically Weighted Regression (FastGWR): a scalable algorithm to investigate spatial process heterogeneity in millions of observations’, International Journal of Geographical Information Science, 33(1), pp. 155–175. Available at: <a target="_blank" rel="noopener" href="https://doi.org/10.1080/13658816.2018.1521523">https://doi.org/10.1080/13658816.2018.1521523</a>.</p>
<h2 id="1-简介">1 简介</h2>
<p>地理加权回归 (GWR) 是一种广泛使用的工具，用于探索地理空间过程中的潜在空间异质性（Brunsdon 等人 1996 年，Fotheringham 等人 1996 年，2002 年）。它已被广泛应用于气候科学（Brown et al., 2012）、地质学（Atkinson et al. 2003）、犯罪学（Cahill and Mulligan 2007）、交通分析（Cardozo et al. 2012）和房屋等诸多领域价格建模（Fotheringham 等人，2015 年）。虽然传统的全球模型假设生成观测数据的过程在任何地方都是相同的，以便为模型中的每个协变量估计单个参数，但 GWR 允许通过在每个位置校准模型以获得特定于位置的参数来放宽此假设每个过程的估计。这是通过使用距离加权方案“借用”数据来实现的，这样附近的数据比在更远的位置观察到的数据的权重更大。通过这种方式，可以获得每个位置的局部参数估计、相关的局部标准误差和 t 值，并且可以将它们映射以探索生成数据的过程中的潜在空间变化</p>
<p>然而，由于 GWR 需要对每个校准位置进行单独回归，因此校准算法需要大量计算。许多研究明确报告了 GWR 的计算限制（Osborne 和 Suárez-Seoane 2002，Griffith 2008），尽管这些限制通常远小于局部建模的替代框架，例如特征向量滤波和贝叶斯空间变化系数模型（Wolf 等人. 2018). Harris 等人 (2010) 指出，随着校准位置数量的增加，GWR 呈指数级增长，并且具有 100,000 个观测值的 GWR 模型可能需要两周或更长时间才能校准。 Yu (2007) 不得不使用 68,906 条记录的子样本来校准 GWR 模型，因为使用所有观测值在计算上是不允许的。然而，使用数据的子集存在明显的问题，可能会影响结果的质量并引入样本偏差。 Feuillet 等人 (2018) 探索了 GWR 在具有 40,480 个观测值的数据集上的使用，以研究步行-环境关系之间的空间变化，但由于计算负担而无法直接利用整个数据集。因此，他们将研究区域分成更小的地理单元，为每个地理单元并行校准单独的 GWR 模型，然后汇总结果。但是，此解决方案可能不等同于完整的 GWR 模型，因为子集分析将受到边界和分区效应的影响，从而限制捕获关系中真实空间变化的能力。上面突出显示的挑战表明，当观测数量变得过大（即数万）时，传统的 GWR 工具开始失效。</p>
<p>很少有研究从各种角度努力解决 GWR 中的计算挑战。 Harris 等人 (2010) 在 R 环境中的开源 spgwr 软件包中开发了一个支持网格的 GWR。他们通过实施一种算法来利用 GWR 的可并行性，该算法将特定位置的模型校准集划分到网格计算系统上的一组节点上。尽管取得了这一进展，但包含 31,378 个观测值的数据集仍然需要 1-2 小时来进行模型校准。尽管在网格上使用了 100 个节点，但这种改进的适度可能是算法没有并行计算模型诊断的结果，这可能需要大量的计算成本。 Pozdnoukhov 和 Kaiser (2011) 使用 MapReduce 并行化框架实施了一种可扩展的局部回归算法来分析流式地理参考数据。该算法能够处理相对较少位置的大量流数据，但在处理大量位置时受到严重限制。 Zhang (2010) 提出了一个使用空间索引视角在图形处理单元 (GPU) 上运行 GWR 的理论并行框架，但没有提供操作实现。最后，Tran 等人。 (2016) 利用 Spark 框架实现了分布式 GWR；然而，这需要一个集群计算环境，普通用户不容易访问。</p>
<p>因此，尽管做出了这些努力，仍然缺乏能够在合理的时间范围内分析大量观测值的可操作且可访问的 GWR 算法。随着以越来越精细的空间分辨率收集数据，具有数十万个观测值的数据集变得司空见惯。因此，需要 GWR 算法的新实现来消除计算瓶颈并在非常大的数据集中启用应用程序。</p>
<h2 id="2-GWR的基础知识">2 GWR的基础知识</h2>
<h3 id="2-1-模型制定">2.1 模型制定</h3>
<p>地理加权回归 (GWR) 通过数据借用方案在每个位置校准单独的回归模型，该方案对来自回归点的观测值进行距离加权。它被表述为</p>
<p>yi 1⁄4 k X j1⁄41 βijxij þ εi</p>
<p>其中 yi 是位置 i 处的响应变量，i 2 1； 2; …; n f , xij g 是第 j 个预测变量，j 2 1； 2; …; k f , βij g 是第 j 个参数估计值，εi 是误差项。矩阵形式的 GWR 校准由下式给出</p>
<p>^ βi 1⁄4 XT WiX 1 XT Wiy</p>
<p>其中 ^ βi 是位置 i 处参数估计的 k x 1 行向量。 X 是预测变量的 n×k 矩阵，y 是响应变量的 n×1 矩阵，Wi 是 n×n 对角空间加权矩阵 specifictolocationi，它是根据指定的核函数和带宽计算的。最广泛使用的核函数是双平方和高斯函数，尽管也使用了其他函数，例如三立方体核函数（McMillen 和 McDonald，2004 年）。双平方和高斯核函数的方程式由下式给出：</p>
<p>Bisquare wij ¼ 1 dij bw 2 "2 # if dij &lt; bw 0 otherwise Gaussian wij ¼ e 1=2 dij bw 2 (3)</p>
<p>其中 wij 是位置 i 和 j 之间的权重，dij 是 i 和 j 之间的距离，bw 是带宽参数，它可以是最近邻居的数量（生成空间自适应带宽）或邻域的距离半径（产生空间固定带宽）（Fotheringham 等人，2002 年）。带宽是控制 GWR 平滑度的关键参数。如果带宽非常大，GWR 结果将类似于从全局 OLS 获得的结果，参数估计的空间变化很小。如果带宽非常小，估计的参数将随空间变化很大，但可能有非常大的标准误差，因为使用很少的数据点进行估计。因此，找到最佳带宽是基于偏差方差权衡。这通常是通过检查修正后的 Akaike 信息准则 (AICc) 分数来完成的，该分数由下式给出</p>
<p>AICc ¼ 2n ln ^ σ ðÞþnln 2π ðÞþn n þ tr S ðÞ n 2 tr S ðÞ</p>
<p>其中n为观察次数，^σ为估计标准误差，tr(S)为帽子矩阵的迹，作为模型的有效参数个数（ENP），描述模型的复杂度。其他优化标准也可用于生成带宽，例如 AIC、贝叶斯信息标准 (BIC) 或交叉验证 (CV)。黄金分割搜索启发式通常用于有效地搜索与最低 AICc 分数相关联的最佳带宽。</p>
<h3 id="2-2-GWR中的帽子矩阵">2.2 GWR中的帽子矩阵</h3>
<p>帽子矩阵 S，也称为投影矩阵或影响矩阵，是一个 n x n 矩阵，它将响应值投影到拟合值上，使得</p>
<p>^ y ¼ Sy</p>
<p>并且在 GWR 中很重要，因为它需要计算有效参数数 (ENP)、模型诊断（例如 AICc）以及推断统计（例如局部标准误差和局部 t 值）。帽子矩阵 S 的每一行 i 由下式给出：</p>
<p>si ¼ xi XT WiX 1 XT Wi</p>
<p>因此，全帽矩阵 S 可以表示为</p>
<p>S¼ s1 … sn 0 @ 1 A¼ x1 XTW1X 1X T W1 … xn XTWnX 1X T Wn 0 @ 1 A n n</p>
<p>模型的 ENP 由下式给出</p>
<p>ENP ¼ tr S ðÞ</p>
<h3 id="2-3-局部参数估计的标准误差">2.3 局部参数估计的标准误差</h3>
<p>方程 (2) 中表示的校准 GWR 模型的参数估计也可以表示为响应变量 y 的函数，这样</p>
<p>βi 1⁄4 Ci y</p>
<p>Ci 1⁄4 XTWiX 1 XT Wi</p>
<p>此外，令 ^ σ2 为 Yu et al.(2018)a 定义的估计方差</p>
<p>^ σ2 1⁄4 P yi y ^i ð2 Þ n tr S ðÞ</p>
<p>然后，位置 i 处局部参数估计的方差由下式给出</p>
<p>Var ^ βi ¼ diag CiCiT ^</p>
<p>标准误差来自：</p>
<p>SE ^ βi ¼ sqrt var ^ βi h</p>
<p>因此所有参数估计的局部标准误差是</p>
<p>SE ^ β ¼ SE ^ β1 ; SE ^ β2 …SE ^ βn hT i n k</p>
<p>局部 t 值可以计算为</p>
<p>t¼ ^ β SE ^ β 0 @ 1 A n k</p>
<h2 id="3-GWR-校准中的计算问题">3. GWR 校准中的计算问题</h2>
<h3 id="3-1-时间">3.1 时间</h3>
<p>如上所述，大部分 GWR 校准例程涉及计算矩阵运算。对于矩阵乘法，n×m 矩阵乘以 m×k 矩阵的时间复杂度为 O(nmk)，其中大 O 是描述算法效率上限的渐近符号。在计算等式（2）中的局部参数 ^ βi 时，两个最耗时的计算是计算 XT XiX 的 O(k2n) 和计算它的逆 XT WiX 1t 的帽子需要 O(k3) 其中 是观察的数量和k 是预测变量的数量。鉴于 k 通常远小于 n，计算 ^ βi 的时间复杂度为 O(k2n)，并且这将在每个位置重复总共 n 次。因此，如果给定带宽，GWR 中用于校准参数表面的总时间复杂度为 O(k2n2)。如果使用黄金分割搜索寻找最优带宽，其时间复杂度接近log(n)，带宽选择和模型校准的总时间复杂度为O(k2n2logn)。 Harris 等人 (2010) 和 Feuillet 等人 (2018) 都提到 GWR 随着观测数量的增长呈指数级增长。然而，鉴于 GWR 的时间复杂度为 O(k2n2logn) 的详细解释，它以准二次方式缩放，比指数缩放的算法更有效。</p>
<h3 id="3-2-内存">3.2 内存</h3>
<p>尽管对每个校准位置进行重复计算会产生时间复杂性，但 GWR 校准中的主要瓶颈在于存储帽子矩阵和其他模型结果所产生的内存复杂性。假设 n = 100,000，每个数字都用 32 位浮点数表示，仅 n×n 的帽矩阵就需要 38GB 的​​内存，这已经超过或非常接近大多数台式机的极限。当前的开源 GWR 软件，例如 Python 空间分析库 (PySAL) 中基于 Python 的 MGWR 模块，或基于 R 的 GWmodel (Gollini et al. 2013) 和 spgwr (Bivand et al. 2017) 包，存储整个 n通过内存中的n个帽子矩阵。 Harris 等人 (2010) 提到了存储帽矩阵的内存要求，但没有报告解决方案。</p>
<h2 id="4-提高-GWR-校准的计算效率">4 提高 GWR 校准的计算效率</h2>
<p>通常，GWR 校准分两步进行。第一步（第 4.1 节）涉及通过最小化模型诊断（例如 AICc）来找到最佳带宽。第二步（第 4.2 节）涉及局部参数估计、标准误差和 t 值的计算，以及一些基于最佳带宽的模型诊断。我们现在演示 FastGWR 如何能够在不存储整个帽矩阵的情况下执行这两个步骤，从而显著降低 O(n2) 到 O(nk) 的内存复杂性，并使校准过程对于非常大的数据集而言可访问且高效。</p>
<h3 id="4-1-优化-AICc-计算以获得最佳带宽选择">4.1 优化 AICc 计算以获得最佳带宽选择</h3>
<p>考虑等式 (4) 中的 AICc 公式，它可以等效地表示为</p>
<p>AICc ¼ n ln RSS n tr S ðÞ þ nln 2π ðÞþn n þ tr S ðÞ n 2 tr S ðÞ</p>
<p>其中 RSS 是残差平方和，tr S ðÞ 是参数的有效个数。请注意，RSS 计算为</p>
<p>RSS ¼ n X i¼1 εi2 ¼ n X i¼1 yi y ^i ð2 Þ</p>
<p>其中 εi 是位置 i 处的残差，yi 和 y ^i 是位置 i 处因变量的观测值和拟合值，并且</p>
<p>y ^i ¼ xi ^ βi</p>
<p>其中 xi 是预测矩阵的第 i 行</p>
<p>y ^i ¼ xiCiy</p>
<p>其中</p>
<p>Ci ¼ XT WiX 1 XT Wi</p>
<p>由于用于计算 Ci 的特定于位置的距离权重 Wi 是一个只有对角线非零元素的稀疏矩阵，它也可以表示为一个密集的 1 n 行向量，使得</p>
<p>Wi ¼ wi1 wi2 … . win 0 BB@ 1 CCA n n ) wi ¼ wi1 … win ð 1 n</p>
<p>行向量 wi 可能具有不同程度的稀疏性，具体取决于所采用的带宽估计和空间内核。如果带宽较小且使用双方核，wi 可能会非常稀疏，因为远距离观测值将被加权为零。相反，如果使用大带宽，wi 可以是密集的，特别是对于非截断函数，例如高斯核。计算成本可能会根据 wi 的稀疏性而变化。</p>
<p>让</p>
<p>Pi ¼ XTWi ¼ x1T wi … xkT wi 0 @ 1 A k n</p>
<p>其中 xjT 是预测矩阵 X 的第 j 列的行向量，xjT wi 是维度为 1 n 的两个行向量的逐元素乘法。那么 Ci 可以在后续计算中用 Ci 代替，其中</p>
<p>Ci ¼ PiX ð Þ1Pi</p>
<p>局部平方残差 εi2 可以计算为</p>
<p>εi2 ¼ yi y ^i ð2¼ Þyi xiCi y ð2</p>
<p>下一步是计算等式 (8) 中表示的 GWR 参数的有效数量。更新等式 (7) 以使用 Ci (等式 23)，帽子矩阵也可以等效地表示为</p>
<p>S¼ x1 C1 … xn Cn 0 @ 1 A¼ r11 r12 … r21 r22 … . . . r1n rn1 rnn 0 BB@ 1 CCA n n</p>
<p>设 rii 是对角线的第 i 个元素，可以直接计算为</p>
<p>rii ¼ xici</p>
<p>其中ci是方程(23)中Ci的第i列。然后 ENP 可以更有效地计算为帽子矩阵的对角线元素之和，使得</p>
<p>ENP ¼ n X i¼1 rii</p>
<p>而不是等式（8）中的那样。这是因为，对于 S 的每一行，我们只计算对角线上的元素而忽略对角线外的元素，因为它们不在跟踪运算符中使用。这样，我们不需要计算和存储整个帽子矩阵 S 来提取它的对角线元素。此外，在带宽选择中，目标是找到最小化 AICc 的带宽。因此，通过避免计算或存储校准例程的此步骤不必要的其他模型诊断（例如本地标准误差），可以获得进一步的计算节省。</p>
<p>总之，在给定预定义带宽的情况下，算法 1 总结了有效计算 AICc 的步骤。</p>
<p>如上所述，并行化是减少 GWR 模型校准计算时间的直接自然方式（Harris 等人，2010 年）。但是，为了更有效地获得并行化的好处，还必须考虑如何计算模型诊断。由于此处介绍的用于计算 ENP 的加法有助于并行化，RSS 的计算也是如此，因此可以更有效地并行化整个 GWR 校准。与涉及存储整个 n×n 帽子矩阵 S 的传统方法相比，该算法的内存开销减少了，因为最大的存储矩阵是预测变量的 n×k 设计矩阵，这只会导致适度的内存复杂度 O (kn)。</p>
<h3 id="4-2-优化局部标准误差计算">4.2 优化局部标准误差计算</h3>
<p>一旦找到最佳带宽（例如通过黄金分割搜索），局部标准误差计算为</p>
<p>SE ^ βi ¼ sqrt diag Ci C i T ^ σ2 hi ¼ sqrt diag Ci C i T ^ &nbsp;&nbsp; &nbsp;σ</p>
<p>其中 Ci 来自等式 (23)。让</p>
<p>hi ¼ sqrt diag Ci Ci T</p>
<p>以便</p>
<p>SE ^ βi ¼ hi^ σ</p>
<p>其中</p>
<p>RSS 和 tr S ðÞ 可以分别由等式 (16) 和 (25) 计算得出</p>
<p>算法 2 总结了有效计算标准误差的算法的细节。</p>
<p>与 AICc 计算一样，局部标准误差计算也可以很容易地并行化，因为每个校准位置的回归独立于所有其他位置。上述算法的基本内存复杂度为O(kn)，而基本时间复杂度为O(k2n2)。如果使用黄金分割搜索进行带宽选择，那么AICc计算的时间复杂度增加了O(logn)，导致总时间复杂度为O(k2n2logn)</p>
<h2 id="5-FastGWR：使用-Python-和-MPI-的并行实现">5 FastGWR：使用 Python 和 MPI 的并行实现</h2>
<p>上述计算增强是在称为 FastGWR 的完全可并行化 GWR 算法中实现的。实施是使用 Python 执行的，Python 是一种高级开源编程语言。对于算法的并行化，我们使用消息传递接口 (MPI)，这是一种促进并行计算架构的核心和节点之间通信的通用协议 (Gropp et al. 1996)，在许多研究中已被广泛用于科学计算场（Schmidt et al. 2002, Neese 2012,Wuet al. 2013）。选择 MPI 而不是其他替代方案（例如 Hadoop 上的 MapReduce）的主要原因是基于 MPI 的程序可以在具有单个 CPU 和 HPC 集群的计算机上执行。有许多 MPI 实现可用，为了方便起见，我们使用了开源实现 OpenMPI1 (Gabriel et al. 2004)。我们还使用了一个名为 mpi4py2 (Dalcin et al., 2008) 的 MPI Python 包装器将 MPI 直接集成到 FastGWR 算法中。算法 3 中描述了 FastGWR 并行实现的摘要。</p>
<h2 id="6-FastGWR-作为开源程序">6 FastGWR 作为开源程序</h2>
<p>运行 FastGWR 软件例程的脚本和源代码开发文档可通过 GitHub 获得。3 获得软件后，调用 FastGWR 程序的示例如下：</p>
<p>mpiexec – np 32 python <a target="_blank" rel="noopener" href="http://fastgwr-mpi.py">fastgwr-mpi.py</a> – data input.csv – out gwr.csv – a -bw 1000</p>
<p>其中 mpiexec 是执行基于 MPI 的程序的命令；参数——np 32 表示要分配的处理器数量； – data input.csv 是包含坐标和关联的因变量和自变量的输入数据表的名称； -out gwr.csv 是包含 GWR 输出的文件，其中包括每个校准位置的 ID、预测值、残差、局部参数估计和局部标准误差； -a (-f) 表示使用双方（高斯）自适应（固定）带宽； – bw 1000 表示用于校准 GWR 模型的用户定义带宽。如果未给出参数 – bw，程序将默认使用黄金分割搜索启发式算法和 AICc 选择标准来搜索最佳带宽，以校准 GWR 模型。由于 FastGWR 和 MGWR (PySAL) 都是用 Python 编写的，因此可以将 FastGWR 的优势集成到可以通过用户友好的命令行 API 或图形用户界面访问的 MGWR (PySAL) 实现中。但是，这留给以后的工作。</p>
<h2 id="7-一个经验例子">7.一个经验例子</h2>
<h3 id="7-1-数据和模型">7.1 数据和模型</h3>
<h3 id="7-2-测试环境及规范">7.2 测试环境及规范</h3>
<h3 id="7-3-结果">7.3 结果</h3>
<h4 id="7-3-1-128-万房价观测值的-OLS-和-GWR-校准">7.3.1 128 万房价观测值的 OLS 和 GWR 校准</h4>
<h4 id="7-3-2-FastGWR的可扩展性">7.3.2 FastGWR的可扩展性</h4>
<h4 id="7-3-3-FastGWR-与其他开源-GWR-软件在单个桌面上的计算时间比较">7.3.3 FastGWR 与其他开源 GWR 软件在单个桌面上的计算时间比较</h4>
<h4 id="7-3-4-FastGWR-参数估计的验证">7.3.4 FastGWR 参数估计的验证</h4>
<h4 id="7-3-5-减少内存使用">7.3.5 减少内存使用</h4>
<h2 id="8-结论">8 结论</h2>
<p>地理加权回归是一种局部建模技术，广泛应用于各种学科。然而，特定位置的校准过程使得 GWR 的计算量很大，这限制了它的应用仅限于中小型数据集。例如，当前的开源 GWR 软件只能处理最多约 15,000 个地理参考观测的数据集，因为此时的内存需求变得太大。为了允许 GWR 应用于更大的数据集，我们提出了 FastGWR 实现，它比当前软件有几个优势。首先，FastGWR 优化 GWR 校准例程中的线性代数以克服内存限制。结果，内存需求从 O(n2) 减少到 O(nk)，其中 n 是观察的数量，k 是协变量的数量。鉴于在大多数 GWR 应用程序中 k 远小于 n，这种方法可以节省大量内存。例如，如果 n = 100,000 且 k = 10，则 n x k 矩阵仅需要 3.8MB 内存，而 n x n 矩阵需要 38GB。其次，FastGWR 引入了并行模型诊断计算程序，可显著减少 GWR 校准所需的计算时间，比现有实施快 1000 倍。此外，由于在并行框架中可以自然地利用这两个优势，因此 FastGWR 算法会随着可用内核的数量线性扩展。</p>
<p>为了证明 FastGWR 的实用性，我们使用基于 Zillow 数据集的享乐房价模型进行了一项实证研究，该数据集包含洛杉矶市 128 万个单户住宅物业。据我们所知，这是 GWR 模型首次针对超过一百万个位置进行校准（并且可能是此类模型首次针对超过 100,000 个位置进行校准）。使用 512 核计算集群，128 万个位置的带宽选择过程仅用了 4-5 小时，而使用已知带宽的参数估计校准和标准误差计算用了不到 10 分钟。此外，基于 10,000 个数据点的样本，FastGWR 比 MGWR(PySAL) 快约 12 倍，比 GWmodel 快约 160 倍，比 spgwr 快约 3400 倍，并且这些加速甚至随着观察值增加。</p>
<p>因此，FastGWR 可能使 GWR 在规模上不受限制并跨越大型研究区域，避免通过数据聚合或采样牺牲数据质量和分辨率。这其中的一个含义是，GWR 现在可以更轻松地应用于遥感数据或社交媒体数据，其中大量地理参考观测值越来越多。将 GWR 应用于超大型数据集的挑战不再是计算方面的，而是在可视化和解释领域——估计大量局部参数、相关标准误差、t 统计量等的能力。如何有效地解释模型结果提出了重要的新挑战。未来的工作还将侧重于将 FastGWR 中的原理扩展到最近开发的和计算量更大的多尺度 GWR（Fotheringham 等人，2017 年）。</p>
<p>总结一下，FastGWR的优点是：</p>
<ol>
<li>
<p>它将 GWR 校准程序加快几个数量级，尤其是当数据量很大时。</p>
</li>
<li>
<p>它将内存复杂度从 O(n2) 降低到 O(nk)，以允许单个桌面在合理的时间内对数万个观测值运行 GWR。</p>
</li>
<li>
<p>它是一种基于 Python 和 MPI 的开源、并行和可移植的实现，可以在桌面或 HPC 环境中使用。</p>
</li>
<li>
<p>它为将 GWR 应用于非常大的数据集开辟了机会，这在以前被认为是不可能的。</p>
</li>
</ol>
<h2 id="参考文献">参考文献</h2>
<ul id="refplus"><li id="ref-Atkinson2003" data-num="1">[1]  Atkinson, P.M., et al., 2003. Exploring the relations between riverbank erosion and geomorphological controls using geographically weighted logistic regression. Geographical Analysis, 35 (1), 58–82. doi:10.1111/gean.2003.35.issue-1</li><li id="ref-Bivand2017" data-num="2">[2]  Bivand, R., et al., 2017. Package ‘spgwr’. R Software Package.</li><li id="ref-Brown2012" data-num="3">[3]  Brown, S., et al., 2012. Assessment of spatiotemporal varying relationships between rainfall, land cover and surface water area using geographically weighted regression. Environmental Modeling &amp; Assessment, 17 (3), 241–254. doi:10.1007/s10666-011-9289-8</li><li id="ref-Brunsdon1996" data-num="4">[4]  Brunsdon, C., Fotheringham, A.S., and Charlton, M.E., 1996. Geographically weighted regression: a method for exploring spatial nonstationarity. Geographical Analysis, 28 (4), 281–298. doi:10.1111/j.1538-4632.1996.tb00936.x</li><li id="ref-Cahill2007" data-num="5">[5]  Cahill, M. and Mulligan, G., 2007. Using geographically weighted regression to explore local crime patterns. Social Science Computer Review, 25 (2), 174–193. doi:10.1177/0894439307298925</li><li id="ref-Cardozo2012" data-num="6">[6]  Cardozo, O.D., García-Palomares, J.C., and Gutiérrez, J., 2012. Application of geographically weighted regression to the direct forecasting of transit ridership at station-level. Applied Geography, 34, 548–558. doi:10.1016/j.apgeog.2012.01.005</li><li id="ref-Da2016" data-num="7">[7]  Da Silva, A.R. and Fotheringham, A.S., 2016. The multiple testing issue in geographically weighted regression. Geographical Analysis, 48 (3), 233–247. doi:10.1111/gean.2016.48.issue-3</li><li id="ref-Dalcin2008" data-num="8">[8]  Dalcín, L., et al., 2008. MPI for Python: performance improvements and MPI-2 extensions. Journal of Parallel and Distributed Computing, 68 (5), 655–662. doi:10.1016/j.jpdc.2007.09.005</li><li id="ref-Feuillet2018" data-num="9">[9]  Feuillet, T., et al., 2018. A massive geographically weighted regression model of walking-environment relationships. Journal of Transport Geography,68,118–129. doi:10.1016/j.jtrangeo.2018.03.002</li><li id="ref-Fotheringham2002" data-num="10">[10]  Fotheringham, A.S., Brunsdon, C., and Charlton, M., 2002. Geographically weighted regression: the analysis of spatially varying relationships. New York: John Wiley &amp; Sons.</li><li id="ref-Fotheringham1996" data-num="11">[11]  Fotheringham, A.S., Charlton, M.E., and Brunsdon, C., 1996. The geography of parameter space: an investigation into spatial non-stationarity. International Journal of Geographic Information Systems, 10, 605–627. doi:10.1080/026937996137909</li><li id="ref-Fotheringham2015" data-num="12">[12]  Fotheringham, A.S., Crespo, R., and Yao, J., 2015. Geographical and temporal weighted regression (GTWR). Geographical Analysis, 47 (4), 431–452. doi:10.1111/gean.2015.47.issue-4</li><li id="ref-Fotheringham2017" data-num="13">[13]  Fotheringham, A.S., Yang, W., and Kang, W., 2017. Multiscale geographically weighted regression (MGWR). Annals of the American Association of Geographers, 107 (6), 1247–1265. doi:10.1080/ 24694452.2017.1352480</li><li id="ref-Gabriel2004" data-num="14">[14]  Gabriel, E., et al.(2004). Open MPI: goals, concept, and design of a next generation MPI implementation. In: D. Kranzlmüller, P. Kacsuk, J. Dongarra, eds. Recent Advances in Parallel Virtual Machine and Message Passing Interface,EuroPVM/MPI 2004. Lecture Notes in Computer Science, 3241. Berlin: Springer.</li><li id="ref-Gollini2013" data-num="15">[15]  Gollini, I., et al. 2013. GWmodel: an R package for exploring spatial heterogeneity using geographically weighted models. arXiv preprint arXiv:1306.0413.</li><li id="ref-Griffith2008" data-num="16">[16]  Griffith, D.A., 2008. Spatial-filtering-based contributions to a critique of geographically weighted regression (GWR). Environment and Planning A, 40 (11), 2751–2769. doi:10.1068/a38218</li><li id="ref-Gropp1996" data-num="17">[17]  Gropp, W., et al., 1996. A high-performance, portable implementation of the MPI message passing interface standard. Parallel Computing, 22 (6), 789–828. doi:10.1016/0167-8191(96)00024-5</li><li id="ref-Harris2010" data-num="18">[18]  Harris, R., et al., 2010. Grid-enabling geographically weighted regression: a case study of participation in higher education in England. Transactions in GIS,14(1),43–61. doi:10.1111/tgis.2010.14.issue-1</li><li id="ref-McMillen D. P.2004" data-num="19">[19]  McMillen D. P., McDonald, J. F. (2004). Locally Weighted Maximum Likelihood Estimation: Monte Carlo Evidence and an Application. In: L. Anselin, R. J. G. M. Florax, R. S.Jey, eds. Advances in Spatial Econometrics. Advances in Spatial Science. Berlin: Springer.</li><li id="ref-Neese2012" data-num="20">[20]  Neese, F., 2012. The ORCA program system. Wiley Interdisciplinary Reviews: Computational Molecular Science, 2 (1), 73–78.</li><li id="ref-Osborne2002" data-num="21">[21]  Osborne, P.E. and Suárez-Seoane, S., 2002. Should data be partitioned spatially before building large-scale distribution models? Ecological Modelling, 157 (2–3), 249–259. doi:10.1016/S03043800(02)00198-9</li><li id="ref-Pozdnoukhov2011" data-num="22">[22]  Pozdnoukhov, A. and Kaiser, C., 2011. Scalable local regression for spatial analytics. In: Divyakant Agrawal, Isabel Cruz, Christian S. Jensen, Eyal Ofek, and Egemen Tanin, eds. Proceedings of the 19th ACM SIGSPATIAL International Conference on Advances in Geographic Information Systems (GIS '11), ACM, New York, NY, USA, 361–364. doi:10.1145/2093973.2094023</li><li id="ref-Schmidt2002" data-num="23">[23]  Schmidt, H.A., et al., 2002. TREE-PUZZLE: maximum likelihood phylogenetic analysis using quartets and parallel computing. Bioinformatics, 18 (3), 502–504.</li><li id="ref-Tran2016" data-num="24">[24]  Tran, H.T., Nguyen, H.T., and Tran, V.T., 2016. Large-scale geographically weighted regression on Spark. In: Knowledge and Systems Engineering (KSE), 2016 Eighth International Conference on, October. IEEE.,127–132. doi: 10.1177/1753193416669263</li><li id="ref-Wheeler2007" data-num="25">[25]  Wheeler, D.C., 2007. Diagnostic tools and a remedial method for collinearity in geographically weighted regression. Environment and Planning A, 39 (10), 2464–2481. doi:10.1068/a38325</li><li id="ref-Wheeler2009" data-num="26">[26]  Wheeler, D.C., 2009. Simultaneous coefficient penalization and model selection in geographically weighted regression: the geographically weighted lasso. Environment and Planning A, 41 (3), 722–742. doi:10.1068/a40256</li><li id="ref-Wolf2018" data-num="27">[27]  Wolf, L.J., Oshan, T.M., and Fotheringham, A.S., 2018. Single and multiscale models of process spatial heterogeneity. Geographical Analysis, 50 (3), 223–246. doi:10.1111/gean.v50.3</li><li id="ref-Wu2013" data-num="28">[28]  Wu, Y., et al., 2013. Parallelization of a hydrological model using the message passing interface. Environmental Modelling &amp; Software, 43, 124–132. doi:10.1016/j.envsoft.2013.02.002</li><li id="ref-Yu2007" data-num="29">[29]  Yu, D., 2007. Modeling owner-occupied single-family house values in the city of Milwaukee: a geographically weighted regression approach. GIScience &amp; Remote Sensing, 44 (3), 267–282. doi:10.2747/1548-1603.44.3.267</li><li id="ref-Yu2018" data-num="30">[30]  Yu, H., et al., 2018. Inference in multi-scale geographically weighted regression. Open Science Framework. doi: osf.io/g4pbz</li><li id="ref-Zhang2010" data-num="31">[31]  Zhang, J., 2010. Towards personal high-performance geospatial computing (HPC-G): perspectives and a case study. In: Proceedings of the ACM SIGSPATIAL international workshop on high performance and distributed geographic information systems. ACM, 3–10. doi: 10.1002/bit.22603</li></ul>

    <style>
    #refplus, #refplus li{ 
        padding:0;
        margin:0;
        list-style:none;
    }；
    </style>
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>
    <script>
    document.querySelectorAll(".refplus-num").forEach((ref) => {
        let refid = ref.firstChild.href.replace(location.origin+location.pathname,'');
        let refel = document.querySelector(refid);
        let refnum = refel.dataset.num;
        let ref_content = refel.innerText.replace(`[${refnum}]`,'');
        tippy(ref, {
            content: ref_content,
        });
    });
    </script>
    </article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://xishansnow.github.io">西山晴雪</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://xishansnow.github.io/posts/db061403.html">http://xishansnow.github.io/posts/db061403.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://xishansnow.github.io" target="_blank">西山晴雪的知识笔记</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/GeoAI/">GeoAI</a><a class="post-meta__tags" href="/tags/%E7%A9%BA%E9%97%B4%E7%BB%9F%E8%AE%A1%E5%AD%A6/">空间统计学</a><a class="post-meta__tags" href="/tags/%E5%8F%98%E7%B3%BB%E6%95%B0%E6%A8%A1%E5%9E%8B/">变系数模型</a><a class="post-meta__tags" href="/tags/%E5%9C%B0%E7%90%86%E5%8A%A0%E6%9D%83%E5%9B%9E%E5%BD%92/">地理加权回归</a></div><div class="post_share"><div class="social-share" data-image="/img/010.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/27bbfe2b.html"><img class="prev-cover" src="/img/book_18.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">🔥 深度高斯马尔可夫随机场</div></div></a></div><div class="next-post pull-right"><a href="/posts/3a9f5e9d.html"><img class="next-cover" src="/img/book_06.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">🔥 深度克里金法（DeepKriging）</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/234c04d2.html" title="多尺度地理加权回归"><img class="cover" src="/img/book_13.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-15</div><div class="title">多尺度地理加权回归</div></div></a></div><div><a href="/posts/977049a8.html" title="🔥 组合似然法概述"><img class="cover" src="/img/002.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-30</div><div class="title">🔥 组合似然法概述</div></div></a></div><div><a href="/posts/ae7bb62d.html" title="🔥 空间统计学概论"><img class="cover" src="/img/coffe_11.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-20</div><div class="title">🔥 空间统计学概论</div></div></a></div><div><a href="/posts/625b667d.html" title="Cressie 的最新空间统计论述"><img class="cover" src="/img/book_01.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-23</div><div class="title">Cressie 的最新空间统计论述</div></div></a></div><div><a href="/posts/b9f71b0a.html" title="贝叶斯分层模型"><img class="cover" src="/img/009.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-13</div><div class="title">贝叶斯分层模型</div></div></a></div><div><a href="/posts/2f0fe298.html" title="空间思维及贝叶斯方法"><img class="cover" src="/img/003.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-28</div><div class="title">空间思维及贝叶斯方法</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%AE%80%E4%BB%8B"><span class="toc-text">1 简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-GWR%E7%9A%84%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-text">2 GWR的基础知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E6%A8%A1%E5%9E%8B%E5%88%B6%E5%AE%9A"><span class="toc-text">2.1 模型制定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-GWR%E4%B8%AD%E7%9A%84%E5%B8%BD%E5%AD%90%E7%9F%A9%E9%98%B5"><span class="toc-text">2.2 GWR中的帽子矩阵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E5%B1%80%E9%83%A8%E5%8F%82%E6%95%B0%E4%BC%B0%E8%AE%A1%E7%9A%84%E6%A0%87%E5%87%86%E8%AF%AF%E5%B7%AE"><span class="toc-text">2.3 局部参数估计的标准误差</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-GWR-%E6%A0%A1%E5%87%86%E4%B8%AD%E7%9A%84%E8%AE%A1%E7%AE%97%E9%97%AE%E9%A2%98"><span class="toc-text">3. GWR 校准中的计算问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E6%97%B6%E9%97%B4"><span class="toc-text">3.1 时间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E5%86%85%E5%AD%98"><span class="toc-text">3.2 内存</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%8F%90%E9%AB%98-GWR-%E6%A0%A1%E5%87%86%E7%9A%84%E8%AE%A1%E7%AE%97%E6%95%88%E7%8E%87"><span class="toc-text">4 提高 GWR 校准的计算效率</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E4%BC%98%E5%8C%96-AICc-%E8%AE%A1%E7%AE%97%E4%BB%A5%E8%8E%B7%E5%BE%97%E6%9C%80%E4%BD%B3%E5%B8%A6%E5%AE%BD%E9%80%89%E6%8B%A9"><span class="toc-text">4.1 优化 AICc 计算以获得最佳带宽选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E4%BC%98%E5%8C%96%E5%B1%80%E9%83%A8%E6%A0%87%E5%87%86%E8%AF%AF%E5%B7%AE%E8%AE%A1%E7%AE%97"><span class="toc-text">4.2 优化局部标准误差计算</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-FastGWR%EF%BC%9A%E4%BD%BF%E7%94%A8-Python-%E5%92%8C-MPI-%E7%9A%84%E5%B9%B6%E8%A1%8C%E5%AE%9E%E7%8E%B0"><span class="toc-text">5 FastGWR：使用 Python 和 MPI 的并行实现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-FastGWR-%E4%BD%9C%E4%B8%BA%E5%BC%80%E6%BA%90%E7%A8%8B%E5%BA%8F"><span class="toc-text">6 FastGWR 作为开源程序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E4%B8%80%E4%B8%AA%E7%BB%8F%E9%AA%8C%E4%BE%8B%E5%AD%90"><span class="toc-text">7.一个经验例子</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E6%95%B0%E6%8D%AE%E5%92%8C%E6%A8%A1%E5%9E%8B"><span class="toc-text">7.1 数据和模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83%E5%8F%8A%E8%A7%84%E8%8C%83"><span class="toc-text">7.2 测试环境及规范</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-%E7%BB%93%E6%9E%9C"><span class="toc-text">7.3 结果</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-3-1-128-%E4%B8%87%E6%88%BF%E4%BB%B7%E8%A7%82%E6%B5%8B%E5%80%BC%E7%9A%84-OLS-%E5%92%8C-GWR-%E6%A0%A1%E5%87%86"><span class="toc-text">7.3.1 128 万房价观测值的 OLS 和 GWR 校准</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-3-2-FastGWR%E7%9A%84%E5%8F%AF%E6%89%A9%E5%B1%95%E6%80%A7"><span class="toc-text">7.3.2 FastGWR的可扩展性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-3-3-FastGWR-%E4%B8%8E%E5%85%B6%E4%BB%96%E5%BC%80%E6%BA%90-GWR-%E8%BD%AF%E4%BB%B6%E5%9C%A8%E5%8D%95%E4%B8%AA%E6%A1%8C%E9%9D%A2%E4%B8%8A%E7%9A%84%E8%AE%A1%E7%AE%97%E6%97%B6%E9%97%B4%E6%AF%94%E8%BE%83"><span class="toc-text">7.3.3 FastGWR 与其他开源 GWR 软件在单个桌面上的计算时间比较</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-3-4-FastGWR-%E5%8F%82%E6%95%B0%E4%BC%B0%E8%AE%A1%E7%9A%84%E9%AA%8C%E8%AF%81"><span class="toc-text">7.3.4 FastGWR 参数估计的验证</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-3-5-%E5%87%8F%E5%B0%91%E5%86%85%E5%AD%98%E4%BD%BF%E7%94%A8"><span class="toc-text">7.3.5 减少内存使用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E7%BB%93%E8%AE%BA"><span class="toc-text">8 结论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="toc-text">参考文献</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By 西山晴雪</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (true){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="https://cdn.jsdelivr.net/npm/algoliasearch/dist/algoliasearch-lite.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? '' : ''

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script></div></body></html>